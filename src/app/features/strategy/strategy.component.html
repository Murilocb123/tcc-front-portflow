<!-- botÃ£o selecionavel para alternar entre agrupadores -->
<p-panel showHeader="false" styleClass="panel-filter">
    <div class="flex justify-content-between w-full">
        <button
            pButton
            type="button"
            label="Adicionar"
            icon="pi pi-plus"
            class="p-button-success"
            size="small"
        ></button>
        <div class="flex align-items-center gap-2">
            <label for="groupBy" class="w-12rem text-right">Agrupar por:</label>
            <p-dropdown
                [options]="groupBy"
                [(ngModel)]="selectedGroup"
                placeholder="Selecione um agrupador"
                (onChange)="updateGrid()"
            ></p-dropdown>
        </div>
    </div>
</p-panel>

<p-panel>
    <div class="card">
        <p-table
            [value]="gridData"
            dataKey="id"
            [expandedRowKeys]="expandedRows"
            (onRowExpand)="onRowExpand($event)"
            (onRowCollapse)="onRowCollapse($event)"
        >
        >
            <ng-template #header>
                <tr>
                    <th style="width: 5rem"></th>
                    <th class="text-center" *ngFor="let col of columns">{{ col.header }}</th>
                </tr>
            </ng-template>
            <ng-template #body let-rowData let-expanded="expanded">
                <tr>
                    <td>
                        <p-button
                            type="button"
                            pRipple
                            [pRowToggler]="rowData"
                            [text]="true"
                            [rounded]="true"
                            [plain]="true"
                            [icon]="
                                expanded
                                    ? 'pi pi-chevron-down'
                                    : 'pi pi-chevron-right'
                            "
                        ></p-button>
                    </td>
                    <td class="text-center" *ngFor="let col of columns">
                        {{ getFieldValue(rowData, col.field, col?.path) }}
                    </td>
                </tr>
            </ng-template>
            <ng-template #expandedrow let-rowData>
                <tr>
                    <td colspan="7">
                        <p-table
                            [value]="rowData.details"
                            [tableStyle]="{ 'min-width': '50rem' }"
                        >
                            <ng-template #header>
                                <tr>
                                    <th class="text-center"
                                        *ngFor="
                                            let col of columnsHeaderExpanded
                                        "
                                    >
                                        {{ col.header }}
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template #body let-detail>
                                <tr>
                                    <td
                                    class="text-center"
                                        *ngFor="
                                            let col of columnsHeaderExpanded
                                        "
                                    >
                                        {{
                                            getFieldValue(
                                                detail,
                                                col.field,
                                                col?.path
                                            )
                                        }}
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</p-panel>
